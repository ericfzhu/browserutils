const d={trackingEnabled:!0,blockingEnabled:!0,theme:"system",retentionDays:30,idleThreshold:60,displayName:"",quickLinks:[]},n={BLOCKED_SITES:"blockedSites",SETTINGS:"settings",DAILY_STATS:"dailyStats",ACTIVE_SESSION:"activeSession"};async function c(){return(await chrome.storage.local.get(n.BLOCKED_SITES))[n.BLOCKED_SITES]||[]}async function i(t){await chrome.storage.local.set({[n.BLOCKED_SITES]:t})}async function w(t){const a=await c(),e={...t,id:crypto.randomUUID(),createdAt:Date.now()};return a.push(e),await i(a),e}async function h(t){const e=(await c()).filter(s=>s.id!==t);await i(e)}async function y(t){const a=await c(),e=a.findIndex(s=>s.id===t.id);e!==-1&&(a[e]=t,await i(a))}async function T(){const t=await chrome.storage.local.get(n.SETTINGS);return{...d,...t[n.SETTINGS]}}async function A(t){const e={...await T(),...t};return await chrome.storage.local.set({[n.SETTINGS]:e}),e}function r(t=new Date){return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}async function S(t){const a=t||r();return((await chrome.storage.local.get(n.DAILY_STATS))[n.DAILY_STATS]||{})[a]||{date:a,totalTime:0,sites:{},visits:0,blockedAttempts:0}}async function f(){return(await chrome.storage.local.get(n.DAILY_STATS))[n.DAILY_STATS]||{}}async function l(t,a){const s=(await chrome.storage.local.get(n.DAILY_STATS))[n.DAILY_STATS]||{};s[t]=a,await chrome.storage.local.set({[n.DAILY_STATS]:s})}async function m(t){const a=r(),e=await S(a);e.blockedAttempts++,await l(a,e)}async function E(t,a){const e=r(),s=await S(e);s.totalTime+=a,s.sites[t]=(s.sites[t]||0)+a,s.visits++,await l(e,s)}async function I(t){t?await chrome.storage.local.set({[n.ACTIVE_SESSION]:t}):await chrome.storage.local.remove(n.ACTIVE_SESSION)}async function g(t){const e=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(s)).map(u=>u.toString(16).padStart(2,"0")).join("")}async function D(t,a){return await g(t)===a}function _(t,a){try{const s=new URL(t).hostname;if(a.startsWith("*.")){const o=a.slice(2);return s===o||s.endsWith("."+o)}return s===a||s==="www."+a}catch{return!1}}export{c as a,y as b,w as c,S as d,f as e,E as f,T as g,g as h,m as i,_ as m,h as r,I as s,A as u,D as v};
