const f={trackingEnabled:!0,blockingEnabled:!0,theme:"system",retentionDays:30,idleThreshold:60,displayName:"",quickLinks:[]},n={BLOCKED_SITES:"blockedSites",BLOCKED_SITE_FOLDERS:"blockedSiteFolders",SETTINGS:"settings",DAILY_STATS:"dailyStats",ACTIVE_SESSION:"activeSession"};async function i(){return(await chrome.storage.local.get(n.BLOCKED_SITES))[n.BLOCKED_SITES]||[]}async function r(t){await chrome.storage.local.set({[n.BLOCKED_SITES]:t})}async function y(t){const e=await i(),a={...t,id:crypto.randomUUID(),createdAt:Date.now()};return e.push(a),await r(e),a}async function E(t){const a=(await i()).filter(s=>s.id!==t);await r(a)}async function h(t){const e=await i(),a=e.findIndex(s=>s.id===t.id);a!==-1&&(e[a]=t,await r(e))}async function l(){return(await chrome.storage.local.get(n.BLOCKED_SITE_FOLDERS))[n.BLOCKED_SITE_FOLDERS]||[]}async function S(t){await chrome.storage.local.set({[n.BLOCKED_SITE_FOLDERS]:t})}async function m(t){const e=await l(),a={...t,id:crypto.randomUUID()};return e.push(a),await S(e),a}async function D(t){const e=await l(),a=e.findIndex(s=>s.id===t.id);a!==-1&&(e[a]=t,await S(e))}async function I(t){const a=(await l()).filter(o=>o.id!==t);await S(a);const c=(await i()).map(o=>o.folderId===t?{...o,folderId:void 0}:o);await r(c)}async function T(){const t=await chrome.storage.local.get(n.SETTINGS);return{...f,...t[n.SETTINGS]}}async function A(t){const a={...await T(),...t};return await chrome.storage.local.set({[n.SETTINGS]:a}),a}function d(t=new Date){return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}async function u(t){const e=t||d();return((await chrome.storage.local.get(n.DAILY_STATS))[n.DAILY_STATS]||{})[e]||{date:e,totalTime:0,sites:{},visits:0,blockedAttempts:0}}async function _(){return(await chrome.storage.local.get(n.DAILY_STATS))[n.DAILY_STATS]||{}}async function w(t,e){const s=(await chrome.storage.local.get(n.DAILY_STATS))[n.DAILY_STATS]||{};s[t]=e,await chrome.storage.local.set({[n.DAILY_STATS]:s})}async function L(t){const e=d(),a=await u(e);a.blockedAttempts++,await w(e,a)}async function p(t,e){const a=d(),s=await u(a);s.totalTime+=e,s.sites[t]=(s.sites[t]||0)+e,s.visits++,await w(a,s)}async function k(t){t?await chrome.storage.local.set({[n.ACTIVE_SESSION]:t}):await chrome.storage.local.remove(n.ACTIVE_SESSION)}async function g(t){const a=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(s)).map(o=>o.toString(16).padStart(2,"0")).join("")}async function B(t,e){return await g(t)===e}function O(t,e){try{const s=new URL(t).hostname;if(e.startsWith("*.")){const c=e.slice(2);return s===c||s.endsWith("."+c)}return s===e||s==="www."+e}catch{return!1}}export{m as a,l as b,A as c,i as d,r as e,h as f,T as g,g as h,L as i,E as j,y as k,u as l,_ as m,k as n,p as o,O as p,I as r,S as s,D as u,B as v};
