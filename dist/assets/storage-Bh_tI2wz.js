const u={trackingEnabled:!0,blockingEnabled:!0,theme:"system",retentionDays:30,idleThreshold:60},n={BLOCKED_SITES:"blockedSites",SETTINGS:"settings",DAILY_STATS:"dailyStats",ACTIVE_SESSION:"activeSession"};async function c(){return(await chrome.storage.local.get(n.BLOCKED_SITES))[n.BLOCKED_SITES]||[]}async function i(t){await chrome.storage.local.set({[n.BLOCKED_SITES]:t})}async function w(t){const a=await c(),e={...t,id:crypto.randomUUID(),createdAt:Date.now()};return a.push(e),await i(a),e}async function A(t){const e=(await c()).filter(s=>s.id!==t);await i(e)}async function g(t){const a=await c(),e=a.findIndex(s=>s.id===t.id);e!==-1&&(a[e]=t,await i(a))}async function d(){const t=await chrome.storage.local.get(n.SETTINGS);return{...u,...t[n.SETTINGS]}}async function h(t){const e={...await d(),...t};return await chrome.storage.local.set({[n.SETTINGS]:e}),e}async function r(t){const a=t||new Date().toISOString().split("T")[0];return((await chrome.storage.local.get(n.DAILY_STATS))[n.DAILY_STATS]||{})[a]||{date:a,totalTime:0,sites:{},visits:0,blockedAttempts:0}}async function y(){return(await chrome.storage.local.get(n.DAILY_STATS))[n.DAILY_STATS]||{}}async function S(t,a){const s=(await chrome.storage.local.get(n.DAILY_STATS))[n.DAILY_STATS]||{};s[t]=a,await chrome.storage.local.set({[n.DAILY_STATS]:s})}async function f(t){const a=new Date().toISOString().split("T")[0],e=await r(a);e.blockedAttempts++,await S(a,e)}async function m(t,a){const e=new Date().toISOString().split("T")[0],s=await r(e);s.totalTime+=a,s.sites[t]=(s.sites[t]||0)+a,s.visits++,await S(e,s)}async function I(t){t?await chrome.storage.local.set({[n.ACTIVE_SESSION]:t}):await chrome.storage.local.remove(n.ACTIVE_SESSION)}async function T(t){const e=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(s)).map(l=>l.toString(16).padStart(2,"0")).join("")}async function E(t,a){return await T(t)===a}function D(t,a){try{const s=new URL(t).hostname;if(a.startsWith("*.")){const o=a.slice(2);return s===o||s.endsWith("."+o)}return s===a||s==="www."+a}catch{return!1}}export{c as a,g as b,w as c,r as d,y as e,m as f,d as g,T as h,f as i,D as m,A as r,I as s,h as u,E as v};
