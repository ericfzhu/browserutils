let t=null,n=!document.hidden;function i(e,c){try{chrome.runtime.sendMessage({type:e,payload:c})}catch{l()}}function a(){document.hidden||i("HEARTBEAT",{url:window.location.href,timestamp:Date.now()})}function o(){const e=!document.hidden;e!==n&&(n=e,i("VISIBILITY_CHANGE",{visible:e,url:window.location.href,timestamp:Date.now()}),e?d():s())}function d(){t||(a(),t=window.setInterval(a,15e3))}function s(){t&&(clearInterval(t),t=null)}function l(){s(),document.removeEventListener("visibilitychange",o)}function r(){document.addEventListener("visibilitychange",o),document.hidden||d(),i("CONTENT_SCRIPT_READY",{visible:!document.hidden,url:window.location.href,timestamp:Date.now()})}r();
